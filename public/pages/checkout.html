<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Checkout - Dupelify</title>
    <meta name="description" content="Sicher zur Kasse bei Dupelify">
    
    <!-- Preload Stripe -->
    <link rel="preconnect" href="https://js.stripe.com" crossorigin>
    <link rel="dns-prefetch" href="https://js.stripe.com">
    <link rel="preload" href="https://js.stripe.com/v3/" as="script">
    
    <link rel="icon" href="../images/logo/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="/styles/checkout-shopify.css">
</head>
<body class="shopify-checkout">
    <!-- Mobile Header -->
    <header class="shopify-header">
        <div class="shopify-header-content">
            <a href="/" class="shopify-logo">
                <img src="/images/logo/Logo.png" alt="Dupelify">
            </a>
            <button class="cart-summary-toggle" id="cart-summary-toggle">
                <svg width="24" height="24" viewBox="0 0 20 20" fill="none" stroke="currentColor">
                    <path d="M6 2L3 6v14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V6l-3-4z" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    <line x1="3" y1="6" x2="17" y2="6" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M13 10a3 3 0 0 1-6 0" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </button>
        </div>
    </header>

    <main class="shopify-main">
        <!-- Mobile Order Summary Dropdown -->
        <div class="mobile-order-summary" id="mobile-order-summary">
            <button class="summary-toggle" id="summary-toggle-btn" aria-expanded="false">
                <div class="toggle-left">
                    <span class="toggle-text">Bestellübersicht</span>
                    <svg class="chevron" width="11" height="7" viewBox="0 0 11 7">
                        <path d="M5.5 5L10 1.5L11 2.5L5.5 7L0 2.5L1 1.5L5.5 5Z" fill="currentColor"/>
                    </svg>
                </div>
                <span class="summary-total" id="mobile-total">€0.00</span>
            </button>
            <div class="summary-content" id="summary-content" style="display: none;">
                <!-- Cart Items -->
                <div class="summary-items" id="mobile-summary-items"></div>
                
                <!-- Discount Code -->
                <div class="summary-discount">
                    <input type="text" placeholder="Rabattcode" id="mobile-discount-input" class="discount-input">
                    <button class="apply-btn" id="mobile-apply-btn">Anwenden</button>
                </div>
                
                <!-- Totals -->
                <div class="summary-totals">
                    <div class="summary-row">
                        <span>Zwischensumme</span>
                        <span id="mobile-subtotal">€0.00</span>
                    </div>
                    <div class="summary-row">
                        <span>Versand</span>
                        <span class="shipping-free">KOSTENLOS</span>
                    </div>
                    <div class="summary-row total-row">
                        <span>Gesamt</span>
                        <span class="total-price">
                            <span class="currency">EUR</span>
                            <strong id="mobile-total-price">€0.00</strong>
                        </span>
                    </div>
                </div>
            </div>
        </div>

        <div class="shopify-container">
            <!-- Main Checkout Form -->
            <div class="checkout-main-content">
                
                <form id="checkout-form" class="shopify-form">
                    
                    <!-- Custom Express Buttons -->
                    <section class="custom-express-section">
                        <h3 class="express-checkout-title">Express-Checkout</h3>
                        <div class="custom-express-buttons">
                            <button type="button" class="express-btn apple-pay-btn" id="apple-pay-btn">
                                <span class="apple-logo">
                                    <svg width="20" height="24" viewBox="0 0 24 28" fill="white">
                                        <path d="M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z"/>
                                    </svg>
                                </span>
                                <span>Mit <strong>Apple Pay</strong> kaufen</span>
                            </button>
                            <button type="button" class="express-btn klarna-btn" id="klarna-btn">
                                Klarna
                            </button>
                        </div>
                        <div class="or-divider">
                            <span>ODER</span>
                        </div>
                    </section>
                    
                    <!-- Express Checkout Message (hidden by default) -->
                    <div id="express-message" class="express-checkout-message" style="display: none;">
                        <div class="express-message-content">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="#28a745">
                                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                            </svg>
                            <div>
                                <p class="express-message-title">Express Checkout aktiviert</p>
                                <p class="express-message-text">Keine weiteren Informationen erforderlich</p>
                            </div>
                        </div>
                    </div>

                    <!-- Step 1: Email or Phone -->
                    <section class="checkout-section" id="email-section">
                        <div class="section-header">
                            <h2 class="section-title">Schritt 1/3: E-Mail oder Telefon</h2>
                            <a href="#" class="sign-in-link">Anmelden</a>
                        </div>
                        <div class="form-field">
                            <input 
                                type="email" 
                                id="email" 
                                name="email" 
                                placeholder="E-Mail oder Handynummer"
                                class="shopify-input"
                            >
                        </div>
                    </section>

                    <!-- Delivery Section -->
                    <section class="checkout-section" id="delivery-section">
                        <h2 class="section-title">Lieferung</h2>
                        
                        <div class="form-field">
                            <label class="field-label">Land/Region</label>
                            <select id="country" name="country" required class="shopify-select">
                                <option value="DE" selected>Deutschland</option>
                                <option value="AT">Österreich</option>
                                <option value="CH">Schweiz</option>
                                <option value="NL">Niederlande</option>
                                <option value="BE">Belgien</option>
                                <option value="FR">Frankreich</option>
                                <option value="IT">Italien</option>
                                <option value="ES">Spanien</option>
                            </select>
                        </div>

                        <div class="form-field">
                            <input 
                                type="text" 
                                id="firstName" 
                                name="firstName" 
                                placeholder="Vorname (optional)"
                                class="shopify-input"
                            >
                        </div>

                        <div class="form-field">
                            <input 
                                type="text" 
                                id="lastName" 
                                name="lastName" 
                                placeholder="Nachname"
                                required
                                class="shopify-input"
                            >
                        </div>

                        <div class="form-field">
                            <input 
                                type="text" 
                                id="address" 
                                name="address" 
                                placeholder="Adresse"
                                required
                                class="shopify-input address-input"
                            >
                            <svg class="search-icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
                                <path d="M14 14L17.5 17.5M16 9C16 12.866 12.866 16 9 16C5.134 16 2 12.866 2 9C2 5.134 5.134 2 9 2C12.866 2 16 5.134 16 9Z" stroke="#767676" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                        </div>

                        <div class="form-field">
                            <input 
                                type="text" 
                                id="apartment" 
                                name="apartment" 
                                placeholder="Wohnung, Etage, usw. (optional)"
                                class="shopify-input"
                            >
                        </div>

                        <div class="form-field">
                            <input 
                                type="text" 
                                id="postalCode" 
                                name="postalCode" 
                                placeholder="Postleitzahl"
                                required
                                class="shopify-input"
                            >
                        </div>

                        <div class="form-field">
                            <input 
                                type="text" 
                                id="city" 
                                name="city" 
                                placeholder="Stadt"
                                required
                                class="shopify-input"
                            >
                        </div>

                        <div class="form-field checkbox-field">
                            <label class="checkbox-label">
                                <input type="checkbox" id="saveInfo" name="saveInfo">
                                <span class="checkbox-text">Diese Informationen für das nächste Mal speichern</span>
                            </label>
                        </div>
                    </section>

                    <!-- Shipping Method -->
                    <section class="checkout-section" id="shipping-section">
                        <h2 class="section-title">Versand Methoden</h2>
                        <div class="shipping-method-box">
                            <div class="shipping-info">
                                <span class="shipping-name">Standardversand</span>
                                <span class="shipping-time">2-3 Werktage</span>
                            </div>
                            <span class="shipping-price">KOSTENLOS</span>
                        </div>
                    </section>

                    <!-- Secure Checkout -->
                    <section class="checkout-section payment-section">
                        <h2 class="section-title">Sichere Bezahlung</h2>
                        <p class="secure-text">Alle Transaktionen sind sicher und verschlüsselt. Ihre Bestellung beinhaltet kostenlosen Rückversand und 24/7 Zugang zu unserem preisgekrönten Kundenservice</p>
                        
                        <!-- Stripe Payment Element -->
                        <div id="payment-element" class="payment-element-wrapper">
                            <!-- Stripe will inject payment methods here -->
                        </div>
                        <div id="payment-message" class="payment-message"></div>
                    </section>

                    <!-- Order Summary (Desktop) -->
                    <section class="checkout-section order-summary-section desktop-only">
                        <h2 class="section-title">Bestellübersicht</h2>
                        <div class="desktop-summary-items" id="desktop-summary-items"></div>
                        
                        <div class="desktop-discount">
                            <input type="text" placeholder="Rabattcode" id="desktop-discount-input" class="discount-input">
                            <button type="button" class="apply-btn" id="desktop-apply-btn">Anwenden</button>
                        </div>

                        <div class="desktop-totals">
                            <div class="summary-row">
                                <span>Zwischensumme</span>
                                <span id="desktop-subtotal">€0.00</span>
                            </div>
                            <div class="summary-row">
                                <span>Versand</span>
                                <span class="shipping-free">KOSTENLOS</span>
                            </div>
                            <div class="summary-row total-row">
                                <span>Gesamt</span>
                                <span class="total-price">
                                    <span class="currency">EUR</span>
                                    <strong id="desktop-total">€0.00</strong>
                                </span>
                            </div>
                        </div>
                    </section>

                    <!-- Submit Button -->
                    <button type="submit" id="submit-btn" class="submit-button">
                        Bestellung überprüfen
                    </button>

                    <!-- Footer Links -->
                    <div class="checkout-footer-links">
                        <a href="/pages/refund.html">Rückgaberecht</a>
                        <a href="/pages/privacy.html">Datenschutz</a>
                        <a href="/pages/terms.html">AGB</a>
                        <a href="/pages/impressum.html">Impressum</a>
                        <a href="/pages/contact.html">Kontakt</a>
                        <a href="/pages/cookies.html">Cookies</a>
                    </div>

                </form>
            </div>
        </div>
    </main>

    <!-- Scripts -->
    <script src="https://js.stripe.com/v3/"></script>
    <script src="/js/header.js"></script>
    <script src="/js/meta-pixel.js"></script>
    <script src="/js/checkout-express-handler.js"></script>
    <script src="/js/checkout-shopify.js"></script>
</body>
</html>
